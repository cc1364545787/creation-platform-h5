(self.webpackChunktomp=self.webpackChunktomp||[]).push([[2980],{34540:function(K,C,o){"use strict";var f=o(67294),y=o(74308),S=o(86190),m=o(66758),E=["fieldProps","proFieldProps"];function P(){return P=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},P.apply(this,arguments)}function x(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,i)}return e}function D(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?x(Object(e),!0).forEach(function(i){M(t,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):x(Object(e)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})}return t}function M(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function O(t,r){if(t==null)return{};var e=d(t,r),i,n;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(n=0;n<u.length;n++)i=u[n],!(r.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,i)||(e[i]=t[i]))}return e}function d(t,r){if(t==null)return{};var e={},i=Object.keys(t),n,u;for(u=0;u<i.length;u++)n=i[u],!(r.indexOf(n)>=0)&&(e[n]=t[n]);return e}var a="dateRange",s=f.forwardRef(function(t,r){var e=t.fieldProps,i=t.proFieldProps,n=O(t,E),u=(0,f.useContext)(m.Z);return f.createElement(y.Z,P({ref:r,mode:"edit",fieldProps:D({getPopupContainer:u.getPopupContainer},e),valueType:a,proFieldProps:i,filedConfig:{valueType:a,lightFilterLabelFormatter:function(l){return(0,S.Z)(l,"YYYY-MM-DD")}}},n))});C.Z=s},64317:function(K,C,o){"use strict";var f=o(67294),y=o(74308),S=o(22270),m=o(66758),E=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],P=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"];function x(){return x=Object.assign||function(n){for(var u=1;u<arguments.length;u++){var c=arguments[u];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(n[l]=c[l])}return n},x.apply(this,arguments)}function D(n,u){var c=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);u&&(l=l.filter(function(v){return Object.getOwnPropertyDescriptor(n,v).enumerable})),c.push.apply(c,l)}return c}function M(n){for(var u=1;u<arguments.length;u++){var c=arguments[u]!=null?arguments[u]:{};u%2?D(Object(c),!0).forEach(function(l){O(n,l,c[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(c)):D(Object(c)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(c,l))})}return n}function O(n,u,c){return u in n?Object.defineProperty(n,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[u]=c,n}function d(n,u){if(n==null)return{};var c=a(n,u),l,v;if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);for(v=0;v<_.length;v++)l=_[v],!(u.indexOf(l)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,l)||(c[l]=n[l]))}return c}function a(n,u){if(n==null)return{};var c={},l=Object.keys(n),v,_;for(_=0;_<l.length;_++)v=l[_],!(u.indexOf(v)>=0)&&(c[v]=n[v]);return c}var s=f.forwardRef(function(n,u){var c=n.fieldProps,l=n.children,v=n.params,_=n.proFieldProps,A=n.mode,L=n.valueEnum,g=n.request,Z=n.showSearch,I=n.options,R=d(n,E),F=(0,f.useContext)(m.Z);return f.createElement(y.Z,x({mode:"edit",valueEnum:(0,S.h)(L),request:g,params:v,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:M({options:I,mode:A,showSearch:Z,getPopupContainer:F.getPopupContainer},c),ref:u,proFieldProps:_},R),l)}),t=f.forwardRef(function(n,u){var c=n.fieldProps,l=n.children,v=n.params,_=n.proFieldProps,A=n.mode,L=n.valueEnum,g=n.request,Z=n.options,I=d(n,P),R=M({options:Z,mode:A||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label",filterOption:!1},c),F=(0,f.useContext)(m.Z);return f.createElement(y.Z,x({mode:"edit",valueEnum:(0,S.h)(L),request:g,params:v,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:M({getPopupContainer:F.getPopupContainer},R),ref:u,proFieldProps:_},I),l)}),r=s,e=t,i=r;i.SearchSelect=e,i.displayName="ProFormComponent",C.Z=i},5966:function(K,C,o){"use strict";var f=o(67294),y=o(74308),S=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"];function E(){return E=Object.assign||function(a){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},E.apply(this,arguments)}function P(a,s){if(a==null)return{};var t=x(a,s),r,e;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);for(e=0;e<i.length;e++)r=i[e],!(s.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(a,r)||(t[r]=a[r]))}return t}function x(a,s){if(a==null)return{};var t={},r=Object.keys(a),e,i;for(i=0;i<r.length;i++)e=r[i],!(s.indexOf(e)>=0)&&(t[e]=a[e]);return t}var D="text",M=function(s){var t=s.fieldProps,r=s.proFieldProps,e=P(s,S);return f.createElement(y.Z,E({mode:"edit",valueType:D,fieldProps:t,filedConfig:{valueType:D},proFieldProps:r},e))},O=function(s){var t=s.fieldProps,r=s.proFieldProps,e=P(s,m);return f.createElement(y.Z,E({mode:"edit",valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:D}},e))},d=M;d.Password=O,d.displayName="ProFormComponent",C.Z=d},37598:function(K,C,o){"use strict";var f=o(11849),y=o(22542),S=o(85893),m=function(P){var x={search:!1,options:!1,pagination:{defaultPageSize:15,pageSizeOptions:["15","30","50"],showSizeChanger:!0}};return(0,S.jsx)(y.ZP,(0,f.Z)({"data-inspector-line":"21","data-inspector-column":"9","data-inspector-relative-path":"src/components/CustomProTable/index.tsx"},Object.assign({},x,P)))};C.Z=m},9915:function(K,C,o){"use strict";o.r(C),o.d(C,{default:function(){return I}});var f=o(58024),y=o(39144),S=o(13062),m=o(71230),E=o(89032),P=o(15746),x=o(57663),D=o(71577),M=o(3182),O=o(2824),d=o(94043),a=o.n(d),s=o(37598),t=o(67265),r=o(44656),e=o(67294),i=o(58075),n=function(){var R=(0,M.Z)(a().mark(function F(U){return a().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,i.kO)("/soms/log/list",{method:"POST",data:U}));case 1:case"end":return h.stop()}},F)}));return function(U){return R.apply(this,arguments)}}(),u=o(30381),c=o.n(u),l=o(2489),v=o(64317),_=o(5966),A=o(34540),L=o(14877),g=o(85893),Z=function(){var F=(0,e.useState)([c()().subtract(1,"hour"),c()()]),U=(0,O.Z)(F,2),W=U[0],h=U[1],w=(0,e.useState)([]),X=(0,O.Z)(w,2),k=X[0],q=X[1],se=(0,e.useState)(),ee=(0,O.Z)(se,2),le=ee[0],te=ee[1],ue="YYYY.MM.DD HH:mm",ce=(0,e.useState)(""),re=(0,O.Z)(ce,2),pe=re[0],de=re[1],ve=(0,e.useState)(""),ne=(0,O.Z)(ve,2),ae=ne[0],fe=ne[1],me=(0,e.useState)(""),oe=(0,O.Z)(me,2),ge=oe[0],_e=oe[1],he=(0,l.md)(),Pe=(0,l.tT)("@@initialState"),Oe=Pe.initialState,xe=Oe||{},z=xe.currentUser,be=(z==null?void 0:z.roleId)===-1,$=(0,e.useRef)(),ye=function(p){window.open(p.downloadUrl)},Q=180,Ce=function(){var b=(0,M.Z)(a().mark(function p(){var j,B,Y,V,J,T,N,ie;return a().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return B=(j=$.current)===null||j===void 0?void 0:j.pageInfo,Y=B.pageSize,V=B.current,H.next=3,n({page:V-1,limit:Y,startTime:c()(new Date(W[0]).getTime()).unix(),endTime:c()(new Date(W[1]).getTime()).unix(),userId:pe,deviceId:String(ge),appid:ae?String(ae):""});case 3:return J=H.sent,T=J.data,T=T===void 0?{}:T,N=T.dataList,ie=T.total,H.abrupt("return",{data:N,total:ie});case 8:case"end":return H.stop()}},p)}));return function(){return b.apply(this,arguments)}}(),Ee=[{title:"\u65E5\u5FD7\u6587\u4EF6\u540D",dataIndex:"fileName",search:!1},{title:"\u65E5\u5FD7\u4E0A\u4F20\u65F6\u95F4",dataIndex:"createdAt",search:!1},{title:"\u5927\u5C0F",dataIndex:"fileSize",search:!1},{title:"\u64CD\u4F5C",width:100,valueType:"option",render:function(p,j){return be||he["service.clientlog.download"]?(0,g.jsx)(D.Z,{"data-inspector-line":"83","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",type:"link",onClick:function(){return ye(j)},children:"\u4E0B\u8F7D"}):(0,g.jsx)(g.Fragment,{})}}],G=function(p){return p&&(0,L.Vb)(p,"YYYY-MM-DD HH:mm")},De=function(p){q(p.map(G))},Me=function(){return[G(c()()).subtract(1,"hour"),G(c()())]},Se=function(p){p?(te([]),q([])):te(void 0)},Te=function(p){h(p.map(G)||Me())},je=function(p){de(p.target.value)},Le=function(){var b=(0,M.Z)(a().mark(function p(){var j,B,Y,V;return a().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,r.AY)({data:{page:0,limit:1e4,licenseId:0}});case 2:return j=T.sent,B=j.data||{},Y=B.dataList,V=Y===void 0?[]:Y,T.abrupt("return",V.map(function(N){return{label:N.appName,value:N.appId}}));case 5:case"end":return T.stop()}},p)}));return function(){return b.apply(this,arguments)}}();return(0,g.jsxs)(t.ZP,{"data-inspector-line":"135","data-inspector-column":"4","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",children:[(0,g.jsx)(y.Z,{"data-inspector-line":"136","data-inspector-column":"6","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",style:{marginBottom:"16px"},bodyStyle:{paddingBottom:0},children:(0,g.jsxs)(m.Z,{"data-inspector-line":"137","data-inspector-column":"8","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",gutter:32,children:[(0,g.jsx)(P.Z,{"data-inspector-line":"138","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",span:8,xxl:{span:4},children:(0,g.jsx)(v.Z,{"data-inspector-line":"139","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",label:"\u5E94\u7528",allowClear:!0,request:Le,fieldProps:{placeholder:"\u8BF7\u9009\u62E9\u5E94\u7528",onChange:function(p){fe(p)}}})}),(0,g.jsx)(P.Z,{"data-inspector-line":"151","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",span:8,xxl:{span:4},children:(0,g.jsx)(_.Z,{"data-inspector-line":"152","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",label:"\u8BBE\u5907",allowClear:!0,placeholder:"\u8BF7\u8F93\u5165 DeviceId",fieldProps:{onChange:function(p){_e(p.target.value)}}})}),(0,g.jsx)(P.Z,{"data-inspector-line":"163","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",span:8,xxl:{span:4},children:(0,g.jsx)(_.Z,{"data-inspector-line":"164","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",allowClear:!0,label:"\u7528\u6237",placeholder:"\u8BF7\u8F93\u5165 UserId",fieldProps:{onChange:je}})}),(0,g.jsx)(P.Z,{"data-inspector-line":"171","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",span:12,xxl:{span:8},children:(0,g.jsx)(A.Z,{"data-inspector-line":"172","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",tooltip:"\u65E5\u671F\u8DE8\u5EA6\u4E0D\u80FD\u8D85\u8FC7".concat(Q,"\u5929"),label:"\u65F6\u95F4",allowClear:!0,fieldProps:{placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],showTime:!0,allowClear:!1,value:le||W,format:ue,disabledDate:function(p){return(0,L.Q8)(p,k||[],Q)},disabledTime:function(p){return(0,L.d0)(p,k||[],Q)},onCalendarChange:De,onChange:Te,onOpenChange:Se}})}),(0,g.jsx)(D.Z,{"data-inspector-line":"190","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",type:"primary",onClick:function(){var p,j;return(p=$.current)===null||p===void 0||(j=p.reloadAndRest)===null||j===void 0?void 0:j.call(p)},children:"\u641C\u7D22"})]})}),(0,g.jsx)(s.Z,{"data-inspector-line":"195","data-inspector-column":"6","data-inspector-relative-path":"src/pages/ServerManage/ClientLog/index.tsx",actionRef:$,search:!1,request:Ce,rowKey:"id",columns:Ee})]})},I=Z},44656:function(K,C,o){"use strict";o.d(C,{AY:function(){return P}});var f=o(11849),y=o(3182),S=o(94043),m=o.n(S),E=o(58075),P=function(){var a=(0,y.Z)(m().mark(function s(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,E.kO)("/soms/application/list",(0,f.Z)({method:"POST"},t)));case 1:case"end":return e.stop()}},s)}));return function(t){return a.apply(this,arguments)}}(),x=null,D=null,M=null,O=null,d=null},14877:function(K,C,o){"use strict";o.d(C,{Vb:function(){return m},Q8:function(){return E},d0:function(){return P},FK:function(){return x},Uq:function(){return D},KR:function(){return M}});var f=o(2824),y=o(30381),S=o.n(y),m=function(d){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-MM-DD";return S()(d.format(a))},E=function(d,a,s){var t=(0,f.Z)(a,2),r=t[0],e=t[1];if(!r&&!e)return!1;var i=r&&m(d).diff(m(r),"days")>s-1,n=e&&m(e).diff(m(d),"days")>s-1;return n||i},P=function(d,a,s){var t=(0,f.Z)(a,2),r=t[0],e=t[1],i=function(){return Math.abs(m(d).diff(m(r||e),"days"))},n=d?d.date():void 0,u=d?d.hour():void 0,c=[0,0,0],l=c[0],v=c[1],_=!1;if(r){var A,L;_=!0;var g=(r==null||(A=r.format("HH:mm"))===null||A===void 0||(L=A.split(":"))===null||L===void 0?void 0:L.map(Number))||[],Z=(0,f.Z)(g,2);l=Z[0],v=Z[1]}else if(e){var I,R,F=(e==null||(I=e.format("HH:mm"))===null||I===void 0||(R=I.split(":"))===null||R===void 0?void 0:R.map(Number))||[],U=(0,f.Z)(F,2);l=U[0],v=U[1]}return{disabledHours:function(){return new Array(24).fill(0).map(function(h,w){return w}).filter(function(h){if((r||e)&&n){var w=i();if(w===0)return _?h<l&&h>-1:h<24&&h>l;if(w===s-1)return _?h>l:h<l}return!1})},disabledMinutes:function(){return new Array(60).fill(0).map(function(h,w){return w}).filter(function(h){if((r||e)&&n){var w=i();if(w===0&&u===l)return _?h<v:h>v;if(w===s-1&&u===l)return _?h>v:h<v}return!1})}}},x=function(d){var a=new Date(d),s=a.getFullYear()+".",t=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+".",r=a.getDate()<10?"0"+a.getDate():a.getDate();return s+t+r},D=function(d){var a=new Date(d),s=a.getFullYear()+".",t=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+".",r=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",e=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",i=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes();return s+t+r+e+i},M=function(d){return Date.parse(x(d))/1e3}}}]);
