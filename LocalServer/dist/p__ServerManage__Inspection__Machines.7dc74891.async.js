(self.webpackChunktomp=self.webpackChunktomp||[]).push([[112],{7848:function(L){L.exports={box:"box___2ahxC",btnGroup:"btnGroup___BR8R1",resultLine:"resultLine___DKhQB",resultBox:"resultBox___3e1WN"}},37598:function(L,P,t){"use strict";var E=t(11849),C=t(22542),p=t(85893),M=function(b){var A={search:!1,options:!1,pagination:{defaultPageSize:15,pageSizeOptions:["15","30","50"],showSizeChanger:!0}};return(0,p.jsx)(C.ZP,(0,E.Z)({"data-inspector-line":"21","data-inspector-column":"9","data-inspector-relative-path":"src/components/CustomProTable/index.tsx"},Object.assign({},A,b)))};P.Z=M},24453:function(L,P,t){"use strict";t.r(P);var E=t(71194),C=t(5644),p=t(47673),M=t(4107),U=t(22385),b=t(69713),A=t(62350),R=t(75443),Q=t(57663),g=t(71577),y=t(32059),I=t(11849),X=t(34792),h=t(48086),l=t(3182),e=t(2824),s=t(94043),u=t.n(s),n=t(37598),x=t(67265),d=t(2489),S=t(67294),fe=t(7848),T=t.n(fe),K=t(1870),Z=t(79278),r=t(85893),Me=function(){var ge=(0,S.useState)(!1),H=(0,e.Z)(ge,2),Ee=H[0],J=H[1],xe=(0,S.useState)(!1),Y=(0,e.Z)(xe,2),Se=Y[0],q=Y[1],Ie=(0,S.useState)(!1),ee=(0,e.Z)(Ie,2),j=ee[0],B=ee[1],be=(0,S.useState)(""),ne=(0,e.Z)(be,2),ae=ne[0],Oe=ne[1],De=(0,S.useState)({}),te=(0,e.Z)(De,2),O=te[0],W=te[1],Pe=(0,S.useState)(!1),re=(0,e.Z)(Pe,2),se=re[0],ie=re[1],Ce=(0,S.useState)([]),ce=(0,e.Z)(Ce,2),w=ce[0],ue=ce[1],ye=(0,S.useState)(!0),oe=(0,e.Z)(ye,2),Ze=oe[0],Be=oe[1],Le=(0,S.useState)(!0),le=(0,e.Z)(Le,2),Ae=le[0],Te=le[1],je=(0,S.useState)(!1),pe=(0,e.Z)(je,2),Ue=pe[0],k=pe[1],Re=(0,S.useState)([]),de=(0,e.Z)(Re,2),Ke=de[0],We=de[1],we=(0,S.useState)(""),_e=(0,e.Z)(we,2),F=_e[0],ke=_e[1],N=(0,d.md)(),ve=(0,S.useRef)(),Fe=function(){var c=(0,l.Z)(u().mark(function i(a){var o,_,m;return u().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=[],_=!1,m=0,J(!0),v.next=6,(0,Z.x)({page:a.current,limit:a.pageSize}).then(function(D){if(D.code===0){var z,V;o=((z=D.data)===null||z===void 0?void 0:z.dataList)||[],m=((V=D.data)===null||V===void 0?void 0:V.total)||0,_=!0}else D.msg&&h.default.error(D.msg)}).catch(function(D){h.default.error(D)}).finally(function(){J(!1)});case 6:return v.abrupt("return",{data:o,size:o.length,success:_,total:m||0,current:a.current?a.current+1:0});case 7:case"end":return v.stop()}},i)}));return function(a){return c.apply(this,arguments)}}(),Ne=function(i){console.log("\u67E5\u770B\u670D\u52A1",i),d.m8.push("/server-manage/inspection/machine-services/".concat(i))},Ge=function(i){console.log("\u7F16\u8F91\u673A\u5668",i),d.m8.push("/server-manage/inspection/edit-machine/".concat(i))},$e=function(){d.m8.push("/server-manage/inspection/add-machine")},ze=function(i){console.log("\u5220\u9664\u673A\u5668",i),(0,Z.sV)(i).then(function(a){if(a.code===0){var o;h.default.success("\u5220\u9664\u6210\u529F"),(o=ve.current)===null||o===void 0||o.reload()}else a.msg&&h.default.error(a.msg)}).catch(function(a){h.default.error(a)})},he=function(){var c=(0,l.Z)(u().mark(function i(){var a,o;return u().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return B(!0),m.next=3,(0,Z.FF)({serviceName:F});case 3:a=m.sent,a.code===0?(o=a.data||[],ue(o),Be(o.filter(function(f){return!f.enableStop}).length>0),Te(o.filter(function(f){return!f.enableRestart}).length>0)):a.msg&&h.default.error(a.msg),B(!1);case 6:case"end":return m.stop()}},i)}));return function(){return c.apply(this,arguments)}}(),me=function(){!F||(q(!0),Oe(F),he())},G=function(){var c=(0,l.Z)(u().mark(function i(a,o){var _,m;return u().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(_=O[a.serverId],!_){v.next=4;break}return h.default.error("\u6279\u91CF\u64CD\u4F5C\u8FDB\u884C\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\u3002"),v.abrupt("return");case 4:if(!O[a.serverId]){v.next=6;break}return v.abrupt("return");case 6:return W((0,I.Z)((0,I.Z)({},O),{},(0,y.Z)({},a.serverId,!0))),W((0,I.Z)((0,I.Z)({},O),{},(0,y.Z)({},a.serverId,!0))),v.next=10,(0,Z.Mv)(a.serverId,o);case 10:m=v.sent,m.code===0?h.default.success("\u6279\u91CF\u64CD\u4F5C\u8BF7\u6C42\u5DF2\u5904\u7406"):m.msg?h.default.error(m.msg):h.default.error("\u6279\u91CF\u64CD\u4F5C\u8BF7\u6C42\u5904\u7406\u51FA\u9519"),W((0,I.Z)((0,I.Z)({},O),{},(0,y.Z)({},a.serverId,void 0)));case 13:case"end":return v.stop()}},i)}));return function(a,o){return c.apply(this,arguments)}}(),Ve=function(){q(!1),B(!1),ue([])},$=function(){var c=(0,l.Z)(u().mark(function i(a){var o,_;return u().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!se){f.next=3;break}return h.default.error("\u6279\u91CF\u64CD\u4F5C\u8FDB\u884C\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\u3002"),f.abrupt("return");case 3:if(!se){f.next=5;break}return f.abrupt("return");case 5:return B(!0),ie(!0),o=w.map(function(v){return Number(v.serverId)}),f.next=10,(0,Z.fN)(o,a,ae);case 10:_=f.sent,_.code===0?(h.default.success(_.msg),he(),k(!0),We(_.data||[])):_.msg&&h.default.error(_.msg),B(!1),ie(!1);case 14:case"end":return f.stop()}},i)}));return function(a){return c.apply(this,arguments)}}(),Qe=[{title:"ip",align:"center",dataIndex:"serverIp"},{title:"\u7AEF\u53E3",align:"center",dataIndex:"supervisorPort"},{title:"\u8D26\u53F7",align:"center",dataIndex:"supervisorUsername"},{title:"\u64CD\u4F5C",align:"center",valueType:"option",render:function(i,a){var o=O[a.serverId]?O[a.serverId]:!1;return(0,r.jsxs)("div",{"data-inspector-line":"214","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",children:[(0,r.jsx)(g.Z,{"data-inspector-line":"215","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"link",onClick:Ne.bind(null,a.serverId),children:"\u67E5\u770B\u670D\u52A1"}),(0,r.jsx)(d.Nv,{"data-inspector-line":"218","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",accessible:N["service.patrol.machineedit"],children:(0,r.jsx)(g.Z,{"data-inspector-line":"219","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"link",onClick:Ge.bind(null,a.serverId),children:"\u7F16\u8F91"})}),(0,r.jsx)(d.Nv,{"data-inspector-line":"223","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",accessible:N["service.patrol.machinedelete"],children:(0,r.jsx)(R.Z,{"data-inspector-line":"224","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",okButtonProps:{danger:!0},onConfirm:ze.bind(null,a.serverId),children:(0,r.jsx)(g.Z,{"data-inspector-line":"231","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"link",children:"\u5220\u9664"})})}),(0,r.jsx)(g.Z,{"data-inspector-line":"235","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",loading:o,disabled:o,type:"link",icon:(0,r.jsx)(b.Z,{"data-inspector-line":"240","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",title:"\u4E00\u952E\u542F\u52A8\u8BE5\u673A\u5668\u4E0A\u7684\u5168\u90E8\u670D\u52A1",children:(0,r.jsx)(K.Z,{"data-inspector-line":"241","data-inspector-column":"18","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx"})}),onClick:function(){return G(a,"Start")},children:"\u542F\u52A8"}),(0,r.jsx)(g.Z,{"data-inspector-line":"248","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",loading:o,disabled:o,type:"link",icon:(0,r.jsx)(b.Z,{"data-inspector-line":"253","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",title:"\u4E00\u952E\u91CD\u542F\u8BE5\u673A\u5668\u4E0A\u7684\u5168\u90E8\u670D\u52A1",children:(0,r.jsx)(K.Z,{"data-inspector-line":"254","data-inspector-column":"18","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx"})}),onClick:function(){return G(a,"Restart")},children:"\u91CD\u542F"}),(0,r.jsx)(g.Z,{"data-inspector-line":"261","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",loading:o,disabled:o,type:"link",icon:(0,r.jsx)(b.Z,{"data-inspector-line":"266","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",title:"\u4E00\u952E\u505C\u6B62\u8BE5\u673A\u5668\u4E0A\u7684\u5168\u90E8\u670D\u52A1",children:(0,r.jsx)(K.Z,{"data-inspector-line":"267","data-inspector-column":"18","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx"})}),onClick:function(){return G(a,"Stop")},children:"\u505C\u6B62"})]})}}],Xe=function(i){switch(i){case"Stoppend":case"Exited":return"\u5DF2\u505C\u6B62";case"Starting":return"\u542F\u52A8\u4E2D";case"Running":return"\u8FD0\u884C\u4E2D";case"Backoff":return"\u91CD\u8BD5\u4E2D";case"Stopping":return"\u505C\u6B62\u4E2D";case"Fatal":return"\u81F4\u547D\u9519\u8BEF";case"Unknown":default:return"\u672A\u77E5\u72B6\u6001"}},He=[{title:"\u6240\u5728\u673A\u5668",align:"center",dataIndex:"ip"},{title:"\u5F53\u524D\u72B6\u6001",align:"center",render:function(i,a){return Xe(a.stateName)}},{title:"\u8FD0\u884C\u65F6\u5E38",align:"center",dataIndex:"uptimeDesc"}];return(0,r.jsxs)(x.ZP,{"data-inspector-line":"322","data-inspector-column":"4","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",title:"\u673A\u5668\u5217\u8868",children:[(0,r.jsx)(n.Z,{"data-inspector-line":"323","data-inspector-column":"6","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",toolbar:{actions:[(0,r.jsx)(d.Nv,{"data-inspector-line":"326","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",accessible:N["service.patrol.machinecreate"],children:(0,r.jsx)(g.Z,{"data-inspector-line":"327","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"primary",onClick:$e,children:"\u65B0\u589E\u673A\u5668"})})],search:(0,r.jsxs)("div",{"data-inspector-line":"333","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(M.Z,{"data-inspector-line":"334","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",placeholder:"\u8BF7\u8F93\u5165\u5B8C\u6574\u670D\u52A1\u540D\u79F0",onChange:function(i){return ke(i.target.value)},onKeyUp:function(i){return i.key==="Enter"&&me()}}),(0,r.jsx)(g.Z,{"data-inspector-line":"339","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"primary",onClick:me,style:{marginLeft:"10px"},children:"\u641C\u7D22\u670D\u52A1"})]})},loading:Ee,actionRef:ve,search:!1,request:Fe,rowKey:"serverIp",columns:Qe}),(0,r.jsx)(C.Z,{"data-inspector-line":"352","data-inspector-column":"6","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",width:640,visible:Se,title:"\u670D\u52A1\u641C\u7D22\u7ED3\u679C\uFF1A".concat(ae),onCancel:Ve,centered:!0,footer:w.length?(0,r.jsxs)("div",{"data-inspector-line":"360","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",className:T().btnGroup,children:[(0,r.jsx)(g.Z,{"data-inspector-line":"361","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"primary",disabled:j,onClick:function(){return $("Start")},children:"\u4E00\u952E\u542F\u52A8"}),(0,r.jsx)(g.Z,{"data-inspector-line":"368","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"primary",disabled:j||Ae,style:{margin:"0 20px"},onClick:function(){return $("Restart")},children:"\u4E00\u952E\u91CD\u542F"}),(0,r.jsx)(g.Z,{"data-inspector-line":"376","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"primary",disabled:j||Ze,onClick:function(){return $("Stop")},children:"\u4E00\u952E\u505C\u6B62"})]}):(0,r.jsx)(r.Fragment,{}),children:(0,r.jsx)("div",{"data-inspector-line":"389","data-inspector-column":"8","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",className:T().box,children:(0,r.jsx)(n.Z,{"data-inspector-line":"390","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",loading:j,dataSource:w,rowKey:"ip",columns:He,pagination:{hideOnSinglePage:!0}})})}),(0,r.jsx)(C.Z,{"data-inspector-line":"399","data-inspector-column":"6","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",width:320,visible:Ue,title:"\u6279\u91CF\u64CD\u4F5C\u7ED3\u679C",footer:(0,r.jsx)(g.Z,{"data-inspector-line":"404","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",type:"primary",onClick:function(){return k(!1)},children:"\u786E\u5B9A"}),centered:!0,onCancel:function(){return k(!1)},children:(0,r.jsx)("div",{"data-inspector-line":"411","data-inspector-column":"8","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",className:T().resultBox,children:Ke.map(function(c){return(0,r.jsxs)("p",{"data-inspector-line":"414","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",className:T().resultLine,children:[(0,r.jsx)("span",{"data-inspector-line":"415","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",children:c.ip}),(0,r.jsx)("span",{"data-inspector-line":"416","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Inspection/Machines/index.tsx",children:["\u6210\u529F","\u51FA\u9519"][c.opResult]})]},c.ip)})})})]})};P.default=Me},79278:function(L,P,t){"use strict";t.d(P,{x:function(){return U},vz:function(){return b},rl:function(){return A},XQ:function(){return R},sV:function(){return Q},Gl:function(){return g},X1:function(){return y},FF:function(){return I},Mv:function(){return X},fN:function(){return h}});var E=t(3182),C=t(94043),p=t.n(C),M=t(58075),U=function(){var l=(0,E.Z)(p().mark(function e(s){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,M.kO)("/soms/server/list",{method:"GET",params:s}));case 1:case"end":return n.stop()}},e)}));return function(s){return l.apply(this,arguments)}}(),b=function(){var l=(0,E.Z)(p().mark(function e(s){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,M.kO)("/soms/server/".concat(s),{method:"GET"}));case 1:case"end":return n.stop()}},e)}));return function(s){return l.apply(this,arguments)}}(),A=function(){var l=(0,E.Z)(p().mark(function e(s){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,M.kO)("/soms/server",{method:"POST",data:s}));case 1:case"end":return n.stop()}},e)}));return function(s){return l.apply(this,arguments)}}(),R=function(){var l=(0,E.Z)(p().mark(function e(s,u){return p().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,M.kO)("/soms/server/".concat(s),{method:"PUT",data:u}));case 1:case"end":return x.stop()}},e)}));return function(s,u){return l.apply(this,arguments)}}(),Q=function(){var l=(0,E.Z)(p().mark(function e(s){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,M.kO)("/soms/server/".concat(s),{method:"DELETE"}));case 1:case"end":return n.stop()}},e)}));return function(s){return l.apply(this,arguments)}}(),g=function(){var l=(0,E.Z)(p().mark(function e(s){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,M.kO)("/soms/server/services/".concat(s),{method:"GET"}));case 1:case"end":return n.stop()}},e)}));return function(s){return l.apply(this,arguments)}}(),y=function(){var l=(0,E.Z)(p().mark(function e(s,u,n){return p().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,M.kO)("/soms/server/serviceops/".concat(s),{method:"POST",data:{id:s,ops:u,names:n}}));case 1:case"end":return d.stop()}},e)}));return function(s,u,n){return l.apply(this,arguments)}}(),I=function(){var l=(0,E.Z)(p().mark(function e(s){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,M.kO)("/soms/server/services",{method:"POST",data:s}));case 1:case"end":return n.stop()}},e)}));return function(s){return l.apply(this,arguments)}}(),X=function(){var l=(0,E.Z)(p().mark(function e(s,u){return p().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,M.kO)("/soms/server/service/batchops/".concat(s),{method:"POST",data:{id:s,ops:u},timeout:6e4}));case 1:case"end":return x.stop()}},e)}));return function(s,u){return l.apply(this,arguments)}}(),h=function(){var l=(0,E.Z)(p().mark(function e(s,u,n){return p().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,M.kO)("/soms/server/service/batchops",{method:"POST",data:{ids:s,ops:u,name:n}}));case 1:case"end":return d.stop()}},e)}));return function(s,u,n){return l.apply(this,arguments)}}()}}]);
