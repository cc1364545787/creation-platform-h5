(self.webpackChunktomp=self.webpackChunktomp||[]).push([[1327],{34540:function(Y,j,e){"use strict";var d=e(67294),W=e(74308),_=e(86190),D=e(66758),h=["fieldProps","proFieldProps"];function m(){return m=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m.apply(this,arguments)}function Z(t,a){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function A(t){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?Z(Object(n),!0).forEach(function(r){G(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function G(t,a,n){return a in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}function P(t,a){if(t==null)return{};var n=p(t,a),r,s;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(s=0;s<u.length;s++)r=u[s],!(a.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,r)||(n[r]=t[r]))}return n}function p(t,a){if(t==null)return{};var n={},r=Object.keys(t),s,u;for(u=0;u<r.length;u++)s=r[u],!(a.indexOf(s)>=0)&&(n[s]=t[s]);return n}var o="dateRange",i=d.forwardRef(function(t,a){var n=t.fieldProps,r=t.proFieldProps,s=P(t,h),u=(0,d.useContext)(D.Z);return d.createElement(W.Z,m({ref:a,mode:"edit",fieldProps:A({getPopupContainer:u.getPopupContainer},n),valueType:o,proFieldProps:r,filedConfig:{valueType:o,lightFilterLabelFormatter:function(M){return(0,_.Z)(M,"YYYY-MM-DD")}}},s))});j.Z=i},19400:function(Y){Y.exports={chart:"chart___2naCX",emptyText:"emptyText___3AtYf"}},7297:function(Y){Y.exports={chartsContainer:"chartsContainer___iPQJn",tooltip:"tooltip___1_VwU",formContainer:"formContainer___h4oAB"}},40041:function(Y,j,e){"use strict";var d=e(11849),W=e(2824),_=e(67294),D=e(23279),h=e.n(D),m=e(7438),Z=e(19400),A=e.n(Z),G=e(85893),P={xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},dataZoom:[{type:"slider"}],series:[{data:[],type:"line",smooth:!0}],tooltip:{trigger:"axis",axisPointer:{type:"line"}}},p=function(i,t){var a=(0,_.createRef)(),n=(0,_.useState)(),r=(0,W.Z)(n,2),s=r[0],u=r[1];return(0,_.useImperativeHandle)(t,function(){return a.current}),(0,_.useEffect)(function(){var E=h()(function(){s==null||s.resize()},300);return window.addEventListener("resize",E),function(){window.removeEventListener("resize",E)}},[s]),(0,_.useEffect)(function(){var E,M,y=null,S=!i.series||(Array.isArray(i.series)?i.series.every(function(C){var O;return(C==null||(O=C.data)===null||O===void 0?void 0:O.length)===0}):((E=i.series)===null||E===void 0||(M=E.data)===null||M===void 0?void 0:M.length)===0),I=function(){return{title:i.title,xAxis:Array.isArray(i.xAxis)?i.xAxis.map(function(O){return(0,d.Z)((0,d.Z)({},P.xAxis),O)}):(0,d.Z)((0,d.Z)({},P.xAxis),i.xAxis),yAxis:Array.isArray(i.yAxis)?i.yAxis.map(function(O){return(0,d.Z)((0,d.Z)({},P.yAxis),O)}):(0,d.Z)((0,d.Z)({},P.yAxis),i.yAxis),grid:i.grid,axisPointer:i.axisPointer,toolbox:i.toolbox,dataZoom:S?!1:i.dataZoom||P.dataZoom,series:i.series,tooltip:(0,d.Z)((0,d.Z)({},P.tooltip),i.tooltip)}};if(s||u(m.S1(a.current)),s&&s.setOption(I()),S){var K;y=document.createElement("div"),y.innerText="\u6682\u65E0\u6570\u636E",y.className=A().emptyText,(K=a.current)===null||K===void 0||K.appendChild(y)}return function(){var C;(C=y)===null||C===void 0||C.remove(),s==null||s.clear()}},[a,s,i]),(0,G.jsx)("div",{"data-inspector-line":"94","data-inspector-column":"9","data-inspector-relative-path":"src/components/BaseChart/index.tsx",ref:a,className:A().chart,style:i.styles||{}})};j.Z=(0,_.forwardRef)(p)},37598:function(Y,j,e){"use strict";var d=e(11849),W=e(22542),_=e(85893),D=function(m){var Z={search:!1,options:!1,pagination:{defaultPageSize:15,pageSizeOptions:["15","30","50"],showSizeChanger:!0}};return(0,_.jsx)(W.ZP,(0,d.Z)({"data-inspector-line":"21","data-inspector-column":"9","data-inspector-relative-path":"src/components/CustomProTable/index.tsx"},Object.assign({},Z,m)))};j.Z=D},15046:function(Y,j,e){"use strict";var d=e(2824),W=e(11849),_=e(67294),D=e(30381),h=e.n(D),m=e(14877),Z=e(34540),A=e(85893),G={tooltip:!0,tooltipText:"",label:"\u65F6\u95F4",name:void 0,defaultValue:null,defaultRangeValue:{unit:"hour",value:1},formatTemplate:"YYYY.MM.DD HH:mm",disabledDays:30,placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],showTime:{showHour:!0,showMinute:!0},onChange:function(){}},P=function(o,i){var t=(0,W.Z)((0,W.Z)({},G),o),a=function(g){return(0,m.Vb)(g,"YYYY-MM-DD HH:mm")},n=function(){var g,L,U,f,N,ae;return Array.isArray(t.defaultRangeValue)?[a(h()()).subtract((g=t.defaultRangeValue[0])===null||g===void 0?void 0:g.value,(L=t.defaultRangeValue[0])===null||L===void 0?void 0:L.unit),a(h()()).subtract((U=t.defaultRangeValue[1])===null||U===void 0?void 0:U.value,(f=t.defaultRangeValue[1])===null||f===void 0?void 0:f.unit)]:[a(h()()).subtract((N=t.defaultRangeValue)===null||N===void 0?void 0:N.value,(ae=t.defaultRangeValue)===null||ae===void 0?void 0:ae.unit),a(h()())]},r=(0,_.useState)(t.defaultValue),s=(0,d.Z)(r,2),u=s[0],E=s[1],M=(0,_.useState)([]),y=(0,d.Z)(M,2),S=y[0],I=y[1],K=(0,_.useState)(),C=(0,d.Z)(K,2),O=C[0],w=C[1],X=function(g){return(0,m.Q8)(g,S||[],t.disabledDays)},ee=function(g){return(0,m.d0)(g,S||[],t.disabledDays)},te=function(g){g?(w([]),I([])):w(void 0)},k=function(g){I(g.map(function(L){return L&&a(L)}))},T=function(g){var L,U,f=(g==null||(L=g.map)===null||L===void 0?void 0:L.call(g,function(N){return N&&a(N)}))||n();E(f),(U=t.onChange)===null||U===void 0||U.call(t,f)};return(0,_.useImperativeHandle)(i,function(){return{value:u,setValue:E}}),(0,_.useEffect)(function(){if(!Array.isArray(t.defaultValue)||!Array.isArray(u)){var c,g=n();(c=t.onChange)===null||c===void 0||c.call(t,g),E(g)}},[]),(0,_.useMemo)(function(){return(0,A.jsx)(Z.Z,{"data-inspector-line":"127","data-inspector-column":"6","data-inspector-relative-path":"src/components/LimitRangePicker/index.tsx",tooltip:t.tooltip?t.tooltipText||"\u65E5\u671F\u8DE8\u5EA6\u4E0D\u80FD\u8D85\u8FC7".concat(t.disabledDays,"\u5929"):void 0,label:t.label,name:t.name,allowClear:!0,fieldProps:{placeholder:t.placeholder,showTime:Object.assign({},t.showTime,{defaultValue:[(u==null?void 0:u[0])||h()(),(u==null?void 0:u[0])||h()()]}),allowClear:!1,value:O||u,format:t.formatTemplate,disabledDate:X,disabledTime:ee,onCalendarChange:k,onChange:T,onOpenChange:te}})},[O,u,S])};j.Z=(0,_.forwardRef)(P)},74880:function(Y,j,e){"use strict";e.r(j),e.d(j,{default:function(){return _e}});var d=e(58024),W=e(39144),_=e(18106),D=e(51752),h=e(2824),m=e(67294),Z=e(67265),A=e(2489),G=e(89032),P=e(15746),p=e(49111),o=e(19650),i=e(43358),t=e(90290),a=e(9715),n=e(86585),r=e(57663),s=e(71577),u=e(11849),E=e(86582),M=e(34792),y=e(48086),S=e(37598),I=e(3182),K=e(94043),C=e.n(K),O=e(58075),w=function(){var J=(0,I.Z)(C().mark(function x(){return C().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",(0,O.kO)("/soms/cluster/list",{method:"POST"}));case 1:case"end":return B.stop()}},x)}));return function(){return J.apply(this,arguments)}}(),X=function(){var J=(0,I.Z)(C().mark(function x(V){return C().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,O.kO)("/soms/machine/list",(0,u.Z)({method:"POST"},V||{})));case 1:case"end":return b.stop()}},x)}));return function(V){return J.apply(this,arguments)}}(),ee=function(){var J=(0,I.Z)(C().mark(function x(V){return C().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,O.kO)("/soms/resource/list",(0,u.Z)({method:"POST"},V||{})));case 1:case"end":return b.stop()}},x)}));return function(V){return J.apply(this,arguments)}}(),te=null,k=e(40041),T=e(30381),c=e.n(T),g=e(15046),L=e(7297),U=e.n(L),f=e(85893),N=function(){var x=A.m8.location.query,V=(0,m.useState)([]),B=(0,h.Z)(V,2),b=B[0],ie=B[1],ue=(0,m.useState)(x.clusterName||""),re=(0,h.Z)(ue,2),q=re[0],oe=re[1],xe=(0,m.useState)(!1),de=(0,h.Z)(xe,2),ye=de[0],ce=de[1],Ce=(0,m.useState)([]),ve=(0,h.Z)(Ce,2),me=ve[0],De=ve[1],Pe=(0,m.useState)([]),fe=(0,h.Z)(Pe,2),le=fe[0],Ee=fe[1],Me=(0,m.useState)(x.startTime&&x.endTime?[c()(Number(x.startTime)),c()(Number(x.endTime))]:null),pe=(0,h.Z)(Me,2),H=pe[0],Oe=pe[1];(0,m.useEffect)(function(){ce(!0),w().then(function(l){if(l.code===0){var v=l.data||{},R=v.dataList,F=R===void 0?[]:R;De(F)}else l.msg&&y.default.error(l.msg)}).catch(function(l){y.default.error(l)}).finally(function(){ce(!1)})},[]),(0,m.useEffect)(function(){q&&X({data:{clusterName:q}}).then(function(l){if(l.code===0){var v=l.data||{},R=v.dataList,F=R===void 0?[]:R;Ee(F)}else l.msg&&y.default.error(l.msg)}).catch(function(l){y.default.error(l)})},[q]),(0,m.useEffect)(function(){le.length&&H&&Promise.all(le.reduce(function(l,v){var R,F,z=((R=H[0])===null||R===void 0?void 0:R.unix())||0,ne=((F=H[1])===null||F===void 0?void 0:F.unix())||0;return[].concat((0,E.Z)(l),[ee({data:(0,u.Z)((0,u.Z)({},v),{},{resoureType:"1, 2",startTime:z,intervalTime:ne-z})}).then(function($){return $.code===0?$.data:(0,u.Z)((0,u.Z)({},v),{},{cpu:[],mem:[]})})])},[])).then(function(l){var v,R=Math.abs((H==null||(v=H[0])===null||v===void 0?void 0:v.diff(H==null?void 0:H[1],"days"))||0)<1;ie(l.reduce(function(F,z){var ne=z.cpu,$=z.mem,se=z.host;return[].concat((0,E.Z)(F),[{title:"CPU",xAxis:ne.map(function(Q){return c()(Q.collectTime).format(R?"HH:mm":"MM/DD HH:mm")}),series:ne.map(function(Q){return parseFloat(Q.usageTotal)}),address:se},{title:"\u5185\u5B58",xAxis:$.map(function(Q){return c()(Q.collectTime).format(R?"HH:mm":"MM/DD HH:mm")}),series:$.map(function(Q){return parseFloat(Q.usedPercent)}),address:se}])},[]))})},[le,H]);var ge=function(v){oe(v),A.m8.replace({query:(0,u.Z)((0,u.Z)({},x),{},{clusterName:v})})},Te=function(v){Oe(v)},be=[{title:"\u96C6\u7FA4",dataIndex:"clusterName",width:"50%"},{title:"\u673A\u5668\u6570",dataIndex:"machineCount"},{title:"\u64CD\u4F5C",width:100,render:function(v){return(0,f.jsx)(s.Z,{"data-inspector-line":"165","data-inspector-column":"8","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",type:"link",onClick:function(){return ge(v.clusterName)},children:"\u67E5\u770B"})}}];return(0,f.jsx)(P.Z,{"data-inspector-line":"176","data-inspector-column":"4","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",children:q?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(o.Z,{"data-inspector-line":"179","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",className:U().formContainer,children:[(0,f.jsx)(n.Z.Item,{"data-inspector-line":"180","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",label:"\u96C6\u7FA4"}),(0,f.jsx)(t.Z,{"data-inspector-line":"181","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",value:q,className:"common-select",placeholder:"\u8BF7\u9009\u62E9\u96C6\u7FA4",onChange:ge,children:me.map(function(l){var v=l.clusterName;return(0,f.jsx)(t.Z.Option,{"data-inspector-line":"188","data-inspector-column":"16","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",title:v,value:v,children:v},v)})}),(0,f.jsx)(g.Z,{"data-inspector-line":"194","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",onChange:Te})]}),(0,f.jsx)(P.Z,{"data-inspector-line":"196","data-inspector-column":"10","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",className:U().chartsContainer,children:Array.isArray(b)&&b.length?b.map(function(l){var v=l.title,R=l.xAxis,F=l.series,z=l.address;return(0,f.jsx)(k.Z,{"data-inspector-line":"199","data-inspector-column":"18","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",title:[{text:"".concat(z," - ").concat(v,"\u5360\u7528\u7387")}],xAxis:{type:"category",data:R,boundaryGap:!1},yAxis:{type:"value",min:0,max:100,name:"(\u5360\u7528\u7387)",axisLabel:{formatter:"{value} %"}},series:[{data:F,type:"line",smooth:!0}],tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function($){var se=(0,h.Z)($,1),Q=se[0],Re=Q.axisValue,Ae=Q.data;return`<div>
                          <div class="`.concat(U().tooltip,`">
                            <div>\u65F6\u95F4\uFF1A</div>
                            <div>`).concat(Re,`</div>
                          </div>
                          <div class="`).concat(U().tooltip,`">
                            <div>\u5360\u7528\u7387\uFF1A</div>
                            <div>`).concat(Ae,`%</div>
                          </div>
                        </div>`)}}},z+v)}):[]})]}):(0,f.jsx)(S.Z,{"data-inspector-line":"253","data-inspector-column":"8","data-inspector-relative-path":"src/pages/ServerManage/Quota/Tabs/ComputedResourceWatch.tsx",loading:ye,dataSource:me,options:!1,rowKey:"clusterName",search:!1,pagination:!1,columns:be})})},ae=N,he=function(){var x=A.m8.location.query,V=(0,A.md)(),B=(0,m.useState)((x==null?void 0:x.tabCode)||"ComputedResourceWatch"),b=(0,h.Z)(B,2),ie=b[0],ue=b[1],re=function(oe){ue(oe),A.m8.replace({query:{tabCode:oe}})};return(0,f.jsx)(Z.ZP,{"data-inspector-line":"27","data-inspector-column":"4","data-inspector-relative-path":"src/pages/ServerManage/Quota/index.tsx",children:(0,f.jsx)(W.Z,{"data-inspector-line":"28","data-inspector-column":"6","data-inspector-relative-path":"src/pages/ServerManage/Quota/index.tsx",children:(0,f.jsx)(D.Z,{"data-inspector-line":"29","data-inspector-column":"8","data-inspector-relative-path":"src/pages/ServerManage/Quota/index.tsx",destroyInactiveTabPane:!0,activeKey:ie,onChange:re,children:V["service.quota.resource"]&&(0,f.jsx)(D.Z.TabPane,{"data-inspector-line":"39","data-inspector-column":"12","data-inspector-relative-path":"src/pages/ServerManage/Quota/index.tsx",tab:"\u8BA1\u7B97\u8D44\u6E90\u76D1\u63A7",children:(0,f.jsx)(ae,{"data-inspector-line":"40","data-inspector-column":"14","data-inspector-relative-path":"src/pages/ServerManage/Quota/index.tsx"})},"ComputedResourceWatch")})})})},_e=he},14877:function(Y,j,e){"use strict";e.d(j,{Vb:function(){return D},Q8:function(){return h},d0:function(){return m},FK:function(){return Z},Uq:function(){return A},KR:function(){return G}});var d=e(2824),W=e(30381),_=e.n(W),D=function(p){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"YYYY-MM-DD";return _()(p.format(o))},h=function(p,o,i){var t=(0,d.Z)(o,2),a=t[0],n=t[1];if(!a&&!n)return!1;var r=a&&D(p).diff(D(a),"days")>i-1,s=n&&D(n).diff(D(p),"days")>i-1;return s||r},m=function(p,o,i){var t=(0,d.Z)(o,2),a=t[0],n=t[1],r=function(){return Math.abs(D(p).diff(D(a||n),"days"))},s=p?p.date():void 0,u=p?p.hour():void 0,E=[0,0,0],M=E[0],y=E[1],S=!1;if(a){var I,K;S=!0;var C=(a==null||(I=a.format("HH:mm"))===null||I===void 0||(K=I.split(":"))===null||K===void 0?void 0:K.map(Number))||[],O=(0,d.Z)(C,2);M=O[0],y=O[1]}else if(n){var w,X,ee=(n==null||(w=n.format("HH:mm"))===null||w===void 0||(X=w.split(":"))===null||X===void 0?void 0:X.map(Number))||[],te=(0,d.Z)(ee,2);M=te[0],y=te[1]}return{disabledHours:function(){return new Array(24).fill(0).map(function(T,c){return c}).filter(function(T){if((a||n)&&s){var c=r();if(c===0)return S?T<M&&T>-1:T<24&&T>M;if(c===i-1)return S?T>M:T<M}return!1})},disabledMinutes:function(){return new Array(60).fill(0).map(function(T,c){return c}).filter(function(T){if((a||n)&&s){var c=r();if(c===0&&u===M)return S?T<y:T>y;if(c===i-1&&u===M)return S?T>y:T<y}return!1})}}},Z=function(p){var o=new Date(p),i=o.getFullYear()+".",t=(o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1)+".",a=o.getDate()<10?"0"+o.getDate():o.getDate();return i+t+a},A=function(p){var o=new Date(p),i=o.getFullYear()+".",t=(o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1)+".",a=(o.getDate()<10?"0"+o.getDate():o.getDate())+" ",n=(o.getHours()<10?"0"+o.getHours():o.getHours())+":",r=o.getMinutes()<10?"0"+o.getMinutes():o.getMinutes();return i+t+a+n+r},G=function(p){return Date.parse(Z(p))/1e3}}}]);
