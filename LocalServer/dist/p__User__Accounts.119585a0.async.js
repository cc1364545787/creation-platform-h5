(self.webpackChunktomp=self.webpackChunktomp||[]).push([[3824],{64317:function(K,w,e){"use strict";var u=e(67294),x=e(74308),v=e(22270),P=e(66758),j=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],D=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"];function T(){return T=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},T.apply(this,arguments)}function C(t,o){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);o&&(s=s.filter(function(O){return Object.getOwnPropertyDescriptor(t,O).enumerable})),a.push.apply(a,s)}return a}function g(t){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?C(Object(a),!0).forEach(function(s){i(t,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))})}return t}function i(t,o,a){return o in t?Object.defineProperty(t,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[o]=a,t}function p(t,o){if(t==null)return{};var a=l(t,o),s,O;if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(t);for(O=0;O<E.length;O++)s=E[O],!(o.indexOf(s)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,s)||(a[s]=t[s]))}return a}function l(t,o){if(t==null)return{};var a={},s=Object.keys(t),O,E;for(E=0;E<s.length;E++)O=s[E],!(o.indexOf(O)>=0)&&(a[O]=t[O]);return a}var r=u.forwardRef(function(t,o){var a=t.fieldProps,s=t.children,O=t.params,E=t.proFieldProps,z=t.mode,V=t.valueEnum,G=t.request,N=t.showSearch,J=t.options,H=p(t,j),m=(0,u.useContext)(P.Z);return u.createElement(x.Z,T({mode:"edit",valueEnum:(0,v.h)(V),request:G,params:O,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:g({options:J,mode:z,showSearch:N,getPopupContainer:m.getPopupContainer},a),ref:o,proFieldProps:E},H),s)}),d=u.forwardRef(function(t,o){var a=t.fieldProps,s=t.children,O=t.params,E=t.proFieldProps,z=t.mode,V=t.valueEnum,G=t.request,N=t.options,J=p(t,D),H=g({options:N,mode:z||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label",filterOption:!1},a),m=(0,u.useContext)(P.Z);return u.createElement(x.Z,T({mode:"edit",valueEnum:(0,v.h)(V),request:G,params:O,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:g({getPopupContainer:m.getPopupContainer},H),ref:o,proFieldProps:E},J),s)}),n=r,c=d,F=n;F.SearchSelect=c,F.displayName="ProFormComponent",w.Z=F},5966:function(K,w,e){"use strict";var u=e(67294),x=e(74308),v=["fieldProps","proFieldProps"],P=["fieldProps","proFieldProps"];function j(){return j=Object.assign||function(l){for(var r=1;r<arguments.length;r++){var d=arguments[r];for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&(l[n]=d[n])}return l},j.apply(this,arguments)}function D(l,r){if(l==null)return{};var d=T(l,r),n,c;if(Object.getOwnPropertySymbols){var F=Object.getOwnPropertySymbols(l);for(c=0;c<F.length;c++)n=F[c],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(l,n)||(d[n]=l[n]))}return d}function T(l,r){if(l==null)return{};var d={},n=Object.keys(l),c,F;for(F=0;F<n.length;F++)c=n[F],!(r.indexOf(c)>=0)&&(d[c]=l[c]);return d}var C="text",g=function(r){var d=r.fieldProps,n=r.proFieldProps,c=D(r,v);return u.createElement(x.Z,j({mode:"edit",valueType:C,fieldProps:d,filedConfig:{valueType:C},proFieldProps:n},c))},i=function(r){var d=r.fieldProps,n=r.proFieldProps,c=D(r,P);return u.createElement(x.Z,j({mode:"edit",valueType:"password",fieldProps:d,proFieldProps:n,filedConfig:{valueType:C}},c))},p=g;p.Password=i,p.displayName="ProFormComponent",w.Z=p},37598:function(K,w,e){"use strict";var u=e(11849),x=e(22542),v=e(85893),P=function(D){var T={search:!1,options:!1,pagination:{defaultPageSize:15,pageSizeOptions:["15","30","50"],showSizeChanger:!0}};return(0,v.jsx)(x.ZP,(0,u.Z)({"data-inspector-line":"21","data-inspector-column":"9","data-inspector-relative-path":"src/components/CustomProTable/index.tsx"},Object.assign({},T,D)))};w.Z=P},69021:function(K,w,e){"use strict";var u=e(11849),x=e(37476),v=e(85893);function P(j){return(0,v.jsx)(x.Z,(0,u.Z)((0,u.Z)({"data-inspector-line":"6","data-inspector-column":"4","data-inspector-relative-path":"src/components/ModalForm/index.tsx"},j),{},{modalProps:(0,u.Z)((0,u.Z)({},j.modalProps),{maskClosable:!1,destroyOnClose:!0})}))}w.Z=P},99931:function(K,w,e){"use strict";e.r(w),e.d(w,{default:function(){return ae}});var u=e(49111),x=e(19650),v=e(57663),P=e(71577),j=e(71194),D=e(5644),T=e(34792),C=e(48086),g=e(11849),i=e(3182),p=e(9715),l=e(86585),r=e(2824),d=e(94043),n=e.n(d),c=e(67294),F=e(67265),t=e(49101),o=e(37598),a=e(5966),s=e(64317),O=e(69021),E=e(58075),z=function(){var R=(0,i.Z)(n().mark(function A(U){return n().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,E.ZP)("/system/users",{method:"POST",data:U}));case 1:case"end":return y.stop()}},A)}));return function(U){return R.apply(this,arguments)}}(),V=function(){var R=(0,i.Z)(n().mark(function A(U,L){return n().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",(0,E.ZP)("/system/users/".concat(U),{method:"PUT",data:L}));case 1:case"end":return W.stop()}},A)}));return function(U,L){return R.apply(this,arguments)}}(),G=function(){var R=(0,i.Z)(n().mark(function A(U){return n().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,E.ZP)("/system/users",(0,g.Z)({method:"GET"},U||{})));case 1:case"end":return y.stop()}},A)}));return function(U){return R.apply(this,arguments)}}(),N=function(){var R=(0,i.Z)(n().mark(function A(U){return n().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,E.ZP)("/system/users/".concat(U),{method:"DELETE"}));case 1:case"end":return y.stop()}},A)}));return function(U){return R.apply(this,arguments)}}(),J=e(60625),H=e(2489),m=e(85893),S;(function(R){R.Edit="Edit",R.Add="Add"})(S||(S={}));var ae=function(){var R=(0,H.tT)("@@initialState"),A=R.initialState,U=A||{},L=U.currentUser,y=(0,c.useState)(!1),W=(0,r.Z)(y,2),k=W[0],X=W[1],se=(0,c.useState)(S.Add),te=(0,r.Z)(se,2),Q=te[0],re=te[1],oe=l.Z.useForm(),ie=(0,r.Z)(oe,1),Y=ie[0],le=(0,c.useState)(),ne=(0,r.Z)(le,2),q=ne[0],ue=ne[1],ee=(0,c.useRef)(),de=function(){var M=(0,i.Z)(n().mark(function Z(b){var _,B,h;return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(Q!==S.Add){f.next=6;break}return f.next=3,z((0,g.Z)({},b));case 3:_=f.sent,f.next=9;break;case 6:return f.next=8,V((B=q==null?void 0:q.id)!==null&&B!==void 0?B:"",(0,g.Z)({},b));case 8:_=f.sent;case 9:_.code===0?(C.default.success("\u64CD\u4F5C\u6210\u529F"),X(!1),(h=ee.current)===null||h===void 0||h.reload()):_.msg&&C.default.error(_.msg);case 10:case"end":return f.stop()}},Z)}));return function(b){return M.apply(this,arguments)}}(),ce=function(Z){ue(Z),Y.setFieldsValue(Z),re(S.Edit),X(!0)},pe=function(){re(S.Add),X(!0)},me=function(){var M=(0,i.Z)(n().mark(function Z(){var b,_;return n().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,J.JV)({flag:1});case 2:return b=h.sent,_=b.data||[],h.abrupt("return",_.map(function(I){var f=I.id,$=I.name;return{label:$,value:f}}));case 5:case"end":return h.stop()}},Z)}));return function(){return M.apply(this,arguments)}}(),fe=function(Z){D.Z.confirm({title:"\u63D0\u793A",content:(0,m.jsxs)("div",{"data-inspector-line":"79","data-inspector-column":"8","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",children:["\u786E\u8BA4\u5220\u9664",(0,m.jsx)("span",{"data-inspector-line":"80","data-inspector-column":"14","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",style:{color:"red"},children:Z.email}),"\u5417\uFF1F"]}),okButtonProps:{danger:!0},okText:"\u5220\u9664",onOk:function(){var b=(0,i.Z)(n().mark(function B(){var h,I;return n().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,N(Z.id);case 2:h=$.sent,h.code===0?(C.default.success("\u64CD\u4F5C\u6210\u529F"),(I=ee.current)===null||I===void 0||I.reload()):h.msg&&C.default.error(h.msg);case 4:case"end":return $.stop()}},B)}));function _(){return b.apply(this,arguments)}return _}()})},ve=function(){var M=(0,i.Z)(n().mark(function Z(b){var _,B,h;return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,G(b);case 2:return _=f.sent,B=_.data,h=_.total,f.abrupt("return",{data:B,total:h,success:!0});case 6:case"end":return f.stop()}},Z)}));return function(b){return M.apply(this,arguments)}}(),he=[{title:"\u8D26\u53F7",dataIndex:"email"},{title:"\u89D2\u8272",dataIndex:"roleName"},{title:"\u64CD\u4F5C",key:"address",align:"center",valueType:"option",width:140,render:function(Z,b){return b.id!==1&&(L==null?void 0:L.id)!==b.id?(0,m.jsxs)(x.Z,{"data-inspector-line":"125","data-inspector-column":"10","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",size:"middle",children:[(0,m.jsx)(P.Z,{"data-inspector-line":"126","data-inspector-column":"12","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",type:"link",onClick:function(){return ce(b)},children:"\u7F16\u8F91"}),(0,m.jsx)(P.Z,{"data-inspector-line":"129","data-inspector-column":"12","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",type:"link",onClick:function(){return fe(b)},children:"\u5220\u9664"})]}):(0,m.jsx)(m.Fragment,{})}}];return(0,c.useEffect)(function(){k&&Y.resetFields()},[k,Y]),(0,m.jsxs)(F.ZP,{"data-inspector-line":"145","data-inspector-column":"4","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",children:[(0,m.jsx)(o.Z,{"data-inspector-line":"146","data-inspector-column":"6","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",actionRef:ee,columns:he,request:ve,options:!1,search:!1,rowKey:"id",pagination:{pageSize:15,pageSizeOptions:["15","30","50"]},toolBarRender:function(){return[(0,m.jsx)(P.Z,{"data-inspector-line":"158","data-inspector-column":"10","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",icon:(0,m.jsx)(t.Z,{"data-inspector-line":"158","data-inspector-column":"37","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx"}),type:"primary",onClick:pe,children:"\u6DFB\u52A0\u7528\u6237"},"button")]}}),(0,m.jsxs)(O.Z,{"data-inspector-line":"163","data-inspector-column":"6","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",title:"".concat(Q===S.Add?"\u6DFB\u52A0":"\u7F16\u8F91","\u7528\u6237"),onFinish:de,layout:"horizontal",width:480,form:Y,labelAlign:"right",labelCol:{span:4},wrapperCol:{span:20},modalProps:{okText:Q===S.Add?"\u521B\u5EFA":"\u4FDD\u5B58"},visible:k,onVisibleChange:X,children:[Q===S.Add&&(0,m.jsx)(a.Z,{"data-inspector-line":"183","data-inspector-column":"10","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",name:"email",label:"\u8D26\u53F7",fieldProps:{maxLength:30},rules:[{required:!0},{pattern:/^[a-zA-Z0-9-_]+@[a-zA-Z0-9-_]+\.[a-zA-Z0-9-_]{2,}$/,message:"\u8D26\u53F7\u683C\u5F0F\u9519\u8BEF"}]}),Q===S.Add&&(0,m.jsx)(a.Z.Password,{"data-inspector-line":"201","data-inspector-column":"10","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",name:"password",label:"\u521D\u59CB\u5BC6\u7801",fieldProps:{maxLength:16},rules:[{required:!0},{pattern:/^[A-Za-z0-9!@#$%^&*]{8,16}$/,message:"\u5BC6\u7801\u683C\u5F0F\u9519\u8BEF"}]}),(0,m.jsx)(s.Z,{"data-inspector-line":"218","data-inspector-column":"8","data-inspector-relative-path":"src/pages/User/Accounts/index.tsx",name:"roleId",label:"\u89D2\u8272",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272"}],request:me})]})]})}},60625:function(K,w,e){"use strict";e.d(w,{JV:function(){return j},_d:function(){return D},ul:function(){return T},Rd:function(){return C}});var u=e(3182),x=e(94043),v=e.n(x),P=e(58075),j=function(){var g=(0,u.Z)(v().mark(function i(p){return v().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.ZP)("/system/roles/list/".concat(p.flag),{method:"GET"}));case 1:case"end":return r.stop()}},i)}));return function(p){return g.apply(this,arguments)}}(),D=function(){var g=(0,u.Z)(v().mark(function i(p){return v().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.ZP)("/system/roles",{method:"POST",data:p}));case 1:case"end":return r.stop()}},i)}));return function(p){return g.apply(this,arguments)}}(),T=function(){var g=(0,u.Z)(v().mark(function i(p,l){return v().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,P.ZP)("/system/roles/".concat(p),{method:"PUT",data:l}));case 1:case"end":return d.stop()}},i)}));return function(p,l){return g.apply(this,arguments)}}(),C=function(){var g=(0,u.Z)(v().mark(function i(p){return v().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.ZP)("/system/roles/".concat(p),{method:"DELETE"}));case 1:case"end":return r.stop()}},i)}));return function(p){return g.apply(this,arguments)}}()}}]);
